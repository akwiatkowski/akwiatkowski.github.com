---
layout:         default
permalink:      /
---
<div class="grid-super-container">
  <div class="grid grid-container">
    {% for post in site.posts %}
      {% if post.tags contains "todo" %}
        <!-- {{ post.title }} -->
      {% else %}
        <div class="grid-item grid-item-post hidden" style="background-repeat: no-repeat; background-image: url('/img/posts/{{ post.date || date: "%Y-%m-%d" }}_{{ post.slug }}.jpg');">
            <h1><a href="{{ post.url | prepend: site.baseurl }}">{{ post.title }}<a/></h1>
            <h6 class="grid-item-date">{{ post.date | date: "%Y-%m-%d" }}</h6>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  <div id="after-grid"></div>
</div>


<script type="text/javascript">
  $(document).ready(function () {
    // masonry
    var $grid = $('.grid').masonry({
      fitWidth: true,
      columnWidth: 600,
      gutter: 20
    });

    function showNext() {
      isVis = $('#after-grid').visible(true);
      if (isVis) {
        cols = Math.floor( $(window).width() / 600 );
        $(".grid-item.hidden:lt(" + cols + ")").hide().removeClass("hidden").show();
        $('.grid').masonry();
        return true;
      }
      return false;
    }

    function showLoop() {
      setTimeout(function(){
        result = showNext();
        if (result) {
          showLoop();
        }
      },
      400);
    }

    $(window).scroll(function() {
      showNext();
    });

    $('.grid').infinitescroll({
      behavior: 'local',
      binder: $('.grid'), // scroll on this element rather than on the window
      // other options
    });

    showLoop();

  });
</script>
